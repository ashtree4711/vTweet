{% extends "bootstrap/base.html" %}


{% block content %}
<!-- Navigation on top of the website -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
	<div class="container">
		<div class="navbar-header">
			<!-- place for our brand logo, clicking the logo will always bring you back to index page -->
			<a class="navbar-brand" href="/">viTweet</a>

			<div class="container">
				<ul class="nav navbar-nav navbar-right">
					<li class="active"><a href="/">Home</a></li>
					<li><a href="#about">About</a></li>
					<li><a href="#contact">Contact</a></li>
				</ul>

				<!-- basic small search -->
				<form class="navbar-form navbar-right" method="POST" action="/conversation">
					<div class="input-group">
						<input type="text" class="form-control" id="smallSearch" placeholder="Search" name="tweetID">
						<div class="input-group-btn">
							<button class="btn btn-default" type="submit">
							<i class="glyphicon glyphicon-search"></i>
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</nav>


<div class="container">
	<h1>Linear Visualization of Tweet {{response['inv.tweet']['tweet_id']}}:</h1>

	<div class="media">
		<!--<div class="media-left">
			<img src="img_avatar1.png" class="media-object" style="width:45px">
		</div>-->
		<div class="media-left">
			<!-- button with number of replies (to do: number of replies) -->
			<button data-toggle="collapse" data-target="#reply">Replies<span class="badge">{{response['inv.tweet']['number_of_replies']}}</span></button>
			<button data-toggle="collapse" data-target="#reply">Quotes<span class="badge">{{response['inv.tweet']['number_of_quote_tweets']}}</span></button>

		</div>
		<div class="media-body">
			<div class="panel-group">
				<div class="panel panel-primary">
					<!-- main tweet -->
					{{response['inv.tweet']['embeddingCode']|safe}}
					<div class="panel-heading">{{response['inv.tweet']['user']['user_name']}},{{response['inv.tweet']['user']['screen_name']}},{{response['inv.tweet']['timestamp']}}</div>
					<div class="panel-body">{{response['inv.tweet']['tweet_content']}}</div>
				</div>
				
				
				<!--
				Quote Tweets:
				{% if response['3.quote_tweets'] %}
					{% for items in response['3.quote_tweets'] %}
						<div>{{items['1.tweet']['tweet_id']}}</div>
						<div>{{items['1.tweet']['user']['user_name']}},{{items['1.tweet']['user']['screen_name']}},{{items['1.tweet']['timestamp']}}</div>
						<div>{{items['1.tweet']['tweet_content']}}</div>
						<br/>
					{% endfor %}
				{% endif %}

				-->

				<!-- Nested media object -->

				{{ render_boxes(response['replies']) }}


			</div>
		</div>

	</div>
</div>
{% endblock %}

{% macro render_boxes(replies) %}
{% for items in replies %}
<div class="media" id="reply" style="margin-bottom: 10px">
	<div class="media-left">
		<button data-toggle="collapse" data-target="#replyofreply">Replies<span class="badge">{{items['inv.tweet']['number_of_replies']}}</span></button>
		<button data-toggle="collapse" data-target="#reply">Quotes<span class="badge">{{items['inv.tweet']['number_of_quote_tweets']}}</span></button>
	</div>
	<div class="media-body">
		<div class="panel panel-default">
			<div class="panel-heading">{{ items['inv.tweet']['user']['user_name'] }}, {{ items['inv.tweet']['user']['screen_name']}},{{ items['inv.tweet']['timestamp']}}</div>
			<div class="panel-body">{{ items['inv.tweet']['tweet_content'] }}</div>
		</div>
		{% if items['replies'] %}
		{{ render_boxes(items['replies']) }}
		{% endif %}
	</div>

</div>

{% endfor %}
{% endmacro %}
